ScreenManager:
    MainScreen:

<MainScreen>:
    name: "main"
    is_connected: False
    status_text: "Not Connected"

    MDScreen:
        md_bg_color: 21/255, 21/255, 21/255, 1

        MDBoxLayout:
            orientation: 'vertical'

            # Connection Status Bar (Added this)
            MDBoxLayout:
                size_hint_y: None
                height: dp(40)
                md_bg_color: (0, 0.7, 0, 1) if root.is_connected else (0.9, 0, 0, 1)
                padding: dp(10)

                MDLabel:
                    text: root.status_text
                    theme_text_color: "Custom"
                    text_color: 243/255, 243/255, 243/255, 1
                    bold: True
                    halign: "center"
                    valign: "center"

            MDLabel:
                text: "Montage Selection"
                font_style: "H4"
                halign: "center"
                theme_text_color: "Custom"
                text_color: 243/255, 243/255, 243/255, 1
                size_hint_y: None
                height: dp(100)
                bold: True

            ScrollView:
                MDGridLayout:
                    size_hint_y: None
                    height: self.minimum_height
                    cols: 1
                    padding: dp(20)
                    spacing: dp(15)

                    ElementCard:
                        text: "Bipolar"
                        image_source: "images/bipolar.png"
                        dark_image_source: "images/bipolar_dark.png"
                        on_release: app.on_toggle_press(self)

                    ElementCard:
                        text: "Transverse"
                        image_source: "images/transverse.png"
                        dark_image_source: "images/transverse_dark.png"
                        on_release: app.on_toggle_press(self)

                    ElementCard:
                        text: "Hatband"
                        image_source: "images/hatband.png"
                        dark_image_source: "images/hatband_dark.png"
                        on_release: app.on_toggle_press(self)
                    
                    ElementCard:
                        text: "Temporal"
                        image_source: "images/temporal.png"
                        dark_image_source: "images/temporal_dark.png"
                        on_release: app.on_toggle_press(self)

                    
                    ElementCard:
                        text: "Cz Referential"
                        image_source: "images/cz_ref.png"
                        dark_image_source: "images/cz_ref_dark.png"
                        on_release: app.on_toggle_press(self)

                    ElementCard:
                        text: "Ear Referential"
                        image_source: "images/ear_ref.png"
                        dark_image_source: "images/ear_ref_dark.png"
                        on_release: app.on_toggle_press(self)

                    ElementCard:
                        text: "Large Baby"
                        image_source: "images/large_baby.png"
                        dark_image_source: "images/large_baby_dark.png"
                        on_release: app.on_toggle_press(self)

                    ElementCard:
                        text: "Small Baby"
                        image_source: "images/small_baby.png"
                        dark_image_source: "images/small_baby_dark.png"
                        on_release: app.on_toggle_press(self)

                    ElementCard:
                        text: "ECI"
                        image_source: "images/eci.png" 
                        dark_image_source: "images/eci_dark.png"
                        on_release: app.on_toggle_press(self)

<ElementCard@MDCard>:
    active: False
    md_bg_color: (243/255, 243/255, 243/255, 1) if self.active else (46/255, 46/255, 46/255, 1)
    padding: dp(15)
    spacing: dp(10)
    radius: dp(25)
    ripple_behavior: True
    text: ""
    image_source: ""
    dark_image_source: "" # change
    pos_hint: {"center_x": 0.5}
    size_hint_x: 1
    size_hint_y: None
    height: dp(125)

    MDBoxLayout:
        orientation: 'horizontal'
        adaptive_height: True
        spacing: dp(15)

        MDLabel:
            id: label
            text: root.text
            theme_text_color: "Custom"
            text_color: (46/255, 46/255, 46/255, 1) if root.active else (243/255, 243/255, 243/255, 1)
            font_style: "H6"
            halign: "left"
            valign: "center"
            size_hint_x: 0.6
            height: self.texture_size[1]

        Image:
            source: root.image_source
            size_hint_x: None
            size_hint_y: None
            width: dp(97)
            height: dp(97)
            allow_stretch: True
            keep_ratio: True
            pos_hint: {"center_y": 0.5}

        MDIconButton:
            icon: "palette"
            theme_text_color: "Custom"
            text_color:  (46/255, 46/255, 46/255, 1) if root.active else (243/255, 243/255, 243/255, 1)
            on_release: app.show_color_menu(self, root)
            